| **Critère**                        | **Description**                                                                                      |
|------------------------------------|------------------------------------------------------------------------------------------------------|
| **Fonctionnalité principale**      | Exécuter des tests définis dans des fichiers JSON et enregistrer les résultats dans autant de fichiers CSV que de json et dans un tableau de résultat global au format Markdown. |
| **Fichiers de configuration**      | Le script charge les paramètre depuis un fichier de configuration config.json qui se trouve dasn le même chemin que le script. |
| **Paramètre TEST_SCRIPTS_PATH**    | Le paramètre TEST_SCRIPTS_PATH du fichier config.json définit le chemin où sont localisés la définition des commandes à exécutés au format json. |
| **Paramètre LOG_PATH**             | Le paramètre LOG_PATH du fichier config.json définit le chemin où est localisé le fichier de log (_logs par défaut). |
| **Paramètre LOG_OUTPUT**           | Le paramètre LOG_OUTPUT du fichier config.json définit toutes les sorties possibles pour les logs séparés par des virgules (console,file, ...). |
| **Paramètre RESULTS_PATH**         | Le paramètre RESULTS_PATH du fichier config.json définit le chemin où sont localisés les résultats au format csv (_outputs par défaut). |
| **Paramètre FILTER_TESTS**         | Le paramètre FILTER_TEST du fichier config.json définit le filtre sous forme d'expression régulière à appliquer pour sélectionner dans les noms fichiers json de définition des commandes lesquelles sont ceux qui doivent être exécuter. |
| **Paramètre RUN_PATH**             | Le paramètre RUN_WORKDIR du fichier config.json définit le chemin qui doit être définit comme chemin courant lors de l'exécution des commandes définies dans les fichiers json. |
| **Paramètre RESULT_SEPARATOR**     | Le paramètre RESULT_SEPARATOR du fichier config.json définit le séprateur utilisé pour les fichiers csv résultats. |
| **Paramètres du script prinipal**  | Le script prends en arguments les options suivantes : `--filter-tests` (optionnel, écrase la valeur de FILTER_TESTS du config.json), `--run-path` (optionnel, écrase la valeur de RUN_WORKDIR du config.json). |
| **Fichiers d'entrée**              | Les tests sont définis dans des fichiers JSON de définition de commandes à exécuter, situés dans un répertoire spécifié par `TEST_SCRIPTS_PATH`. |
| **Structure du fichier JSON**      | Chaque fichier JSON de définition de commandes à exécuter doit contenir les champs suivants : `command`, `path`, `expected_return_type`, `expected_value`, `timeout`, et `description`. |
| **Paramètre command**              | Le paramètre `command` du fichier JSON de définition de commandes à exécuter décrit la commande à exécuter. |
| **Paramètre run_path**             | Le paramètre `run_path` du fichier JSON de définition de commandes à exécuter définit le chemin qui doit être définit comme chemin courant lors de l'exécution des commandes. Si la valeur est vide ou NA ou N/A, aucun chemin particulier n'est utilisé. Toute autre valeur de chemin valide définit ici est utilisé en priorité sur RUN_PATH ou --run-path. Si la valeur est {RUN_PATH}, alors la valeur de --run-path est utilisé ou sinon celle de RUN_PATH (si l'une des deux est définie, sinon pas de chemin particulier) |
| **Paramètre expected_return_type** | Le paramètre `expected_return_type` du fichier JSON de définition de commandes à exécuter définit le le type de méthode utilisé pour défir un SUCCESS ou un FAILED (peut prendre les valeurs return_code ou output_message). |
| **Paramètre expected_value**       | Le paramètre `expected_value` du fichier JSON de définition de commandes à exécuter, si expected_return_type=return_code alors il définit le code de retour numérique attendu de la commande pour définir un SUCCESS et pour tout autre cas un FAILED. |
| **Paramètre expected_value**       | Le paramètre `expected_value` du fichier JSON de définition de commandes à exécuter, si expected_return_type=output_message alors il définit une expression régulière utilisé pour définir le résultat attendue et qui doit être appliquée à chaque ligne d'une chaîne multi-lignes (si cette expression règulère donne un résultat sur la sortie de la commande, alors le résultat est SUCCESS, sinon FAILED et par défaut UNKNOWN). |
| **Paramètre timeout**              | Le paramètre `timeout` du fichier JSON de définition de commandes à exécuter définit un temps d'exécution de la commande au bout duquel la commande est interrompue. |
| **Paramètre command**              | Le paramètre `description` du fichier JSON de définition de commandes à exécuter donne une description de l'objectif de la commande. |
| **Gestion des répertoires**        | Le script crée les répertoires pour les journaux (`LOG_PATH`) et les résultats (`RESULTS_PATH`) s'ils n'existent pas. |
| **Gestion des chemins**            | Le script test l'existence des chemins TEST_SCRIPTS_PATH, RUN_PATH, --run-path (sortie du script si il n'existe pas), et run_path (le script continu, log l'erreur et commente le statut dans le fichiers de résultats final au format markdown). |
| **Sorties des résultats**          | Les résultats sont enregistrés dans un fichier CSV et un fichier Markdown, avec une ligne d'en-tête appropriée pour chaque fichier json. |
| **sanitization des résultats**     | Avant d'enregistrer les résultats dans le fichier CSV chaque variable est si nécessaire traité par rapport au caractère séparateur utilisé. |
| **Format des résultats**           | Les fichiers résultats CSV contiennent les colonnes : Timestamp, Description, Command, Expected return, Timeout, Rule (écrire le nom court avec un hyperlien vers le fichier dans le répertoire ../${TEST_SCRIPTS_PATH}), Output (contraction sur moins de 40 caractères, suppression des caractères spéciaux et carriage return, affiche le message après ERROR ou CRITICAL), Statut. |
| **Format du résultat général**     | Le fichier Markdown de résultat contient l'aggrégation des résultats des csv avec une table avec des colonnes similaires à ces csv. |
| **Echappement général**            | Les informations à écrire dans le Le fichier Markdown de résultat doivent être traités pour échappé le caratère '|', remplace le par '[PIPE]'. |
| **Gestion des logs**               | Le script génère des logs horodatés dans un fichier avec le même nom que le script et un timestamp dans le chemin de LOG_PATH. |
| **Gestion des erreurs**            | Le script vérifie si les commandes requises sont disponibles et gère les erreurs d'exécution en consignant les messages d'erreur dans un fichier de log. |
| **Timeouts**                       | Chaque commande exécutée a un timeout défini (en millisecondes, par défaut 1000 millisecondes), configurable dans les fichier JSON de définition des commandes. |
| **Logging**                        | Les actions et résultats sont consignés dans un fichier de log et sur la sortie standard pour le suivi et le débogage. |
| **Logging**                        | vérifie que les logs ne soient pas dupliqués sur la console |
| **Logging**                        | Ecrire aussi un fichier de log par test avec le même nom court que le fichier json de définition des commandes contenant aussi la sortie complète de la commande exécutée (mettre l'hyperlien vers ce log dans la colonne des status du markdown) |
| **Logging level**                  | Le niveau de log est ajustable dans le fichier config.json. |
| **Programmation**                  | Utilise python, une librarie csv et la librairie pandas pour optimiser le code |
| **Programmation**                  | N'arrête pas le script principal si une des exécution sort en erreur |
| **Programmation**                  | Corrige le fait que l'affiche du log sur la sortie standard se décale  |

